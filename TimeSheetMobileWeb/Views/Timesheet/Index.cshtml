@model TimeSheetMobileWeb.Models.UpdateTimesheetsView
@using TimeSheetMobileWeb.Models
@using TimeSheetIBusiness
@{
    ViewBag.Title = SiteResources.HomeMenuTimesheet;
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@section head{
<script src="@Url.Content("~/Scripts/TimesheetsScript-1.0.js")" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function () {
        $.mobile.hidePageLoadingMsg();
    });
    </script>

}



<div  id='timesheet' class='container timesheetContainer'>
        
        <h1>@SiteResources.HomeMenuTimesheet
	<span class="pull-right">@Context.Session["CurrentUser"].ToString()</span>
	</h1>
    <div class="date-container">

    <span id="indexPeriod" class='currenttimesheet'>@Model.PeriodString</span>
    <span>
			<ul>
				<li class="icon-add-timesheet" data-role="modal" data-target="#taskSelection">add</li>
				<li class="icon-show-list" data-role="modal" data-target="#recallDelete">List</li>
			</ul>
		</span>
        </div>
           
               <!-- <div class='leaveApplication' data-button-target="@Url.Action("Index", "Home")" ></div>
                <h2><span>Status:</span><span class="currstatus-d">@Model.Status ,</span>&nbsp;
                <span>Total</span><span>:</span><span id='allTotal' class='combinedValue'>@Math.Round(Model.Totals.Sum(), 2)</span> </h2>-->
            <div class="details-content">
            <h2>
            <span><strong>Status:</strong></span> <span class="currstatus-d">@Model.Status</span>
            <span><strong>Total:</strong> </span> <span id='allTotal' class='combinedValue'>@Math.Round(Model.Totals.Sum(), 2)</span>
            </h2>
            </div>
          <input id  = 'periodid' type = "hidden" value = '@Model.Period' />
                                           
<div class="details-content">
           
             @if (Model.Totals != null)
                    {
                        int i = 0;
                       int j=0;
			<table>
			<tbody>
            <tr>
             @foreach (var value in Model.Totals)
                        {
                                              
       
                            <td>
                             <span class='combinedValue'>@Model.CurrentPeriodStart.AddDays(i).DayOfWeek.ToString().Substring(0, 3)</span>
                            </td>
                            i++;
                 }
                 
                

            </tr>
            <tr>
            @foreach (var value in Model.Totals)
                        {
                            <td>
                            <span class='combinedValue grandtotals' id = '@string.Format("DayTimes_Total_{0}", j)'>@Math.Round(value, 2)</span>
                            </td>
                           
                            j++;
                        }
                         </tr>
		</tbody></table>

                    }
                    

<div class="listing">
 <form id="periodform" action = '@Url.Action("Index", "Timesheet")' 
                     data-ajax-url='@Url.Action("Refresh", "Timesheet")' data-ajax-target='allTimesheetsEdit' 
                                            data-ajax-oncomplete='TSM_ConfirmPeriodCallBack' data-ajax="false">
                                           @*<input id="SelectedPeriod" name="SelectedPeriod"  class = 'currentperiodstop' type="hidden" value='@string.Format("({0} -{1})", Model.CurrentPeriodStart.ToShortDateString(), Model.CurrentPeriodStop.ToShortDateString())'/>*@
             </form>
             <div class='allrowsContainer' id='allTimesheetsEdit'>
                  @Html.Partial("Edit", Model)
                  <input type = "hidden" id="periodstart" value = '@Model.CurrentPeriodStart' />
                  <input type = "hidden" id="periodend" value = '@Model.CurrentPeriodStop' />
    
                </div>

</div>                        
                </div>
           </div> 
          <footer>
	<ul>
		<li><a href="#" onclick='GotoUrl("@Url.Action("TimesheetHistory", "Timesheet")")'  class="icon-footer-time"></a>@SiteResources.HomeMenuTimesheets</li>
		<li><a href='#' onclick='GotoUrl("@Url.Action("Index", "Home")")' class="icon-footer-home"></a>@SiteResources.Home</li>
		<li><a href="" class="main-icon-submit main-icon-save submit csubmit-mainform submit-mainform icon-footer-save" data-action-confirm ="@SiteResources.ConfirmSave"
                        data-action-value='False' data-action-container='@Html.PrefixedId(m => m.Submit)'></a>@SiteResources.Save</li>
		<li><a href="" class="main-icon-submit main-icon-send submit fsubmit-mainform submit-mainform icon-footer-submit" data-action-confirm ="@SiteResources.ConfirmSubmit"
                        data-action-value='True' data-action-container='@Html.PrefixedId(m => m.Submit)'></a>@SiteResources.Submit</li>
	</ul>
</footer>    
<div id="taskSelection" style="display:none">
@Html.Action("TaskSelection", "Timesheet");
</div>
<div id="viewSelection" style="display:none">
@Html.Partial("ViewSelection", new ViewDataDictionary<ViewSelectionView>(
    new ViewSelectionView { TaskUpdatorViewId = ViewConfigurationTask.Default.Id, TimesheetViewId = ViewConfigurationRow.Default.Id }));
    </div>
    <div id="recallDelete" style="display:none">
@Html.Action("RecallDelete", "Timesheet")
</div>
<div id="updatesummary" style="display:none">
@Html.Partial("UpdateSummary")
</div>
<div id="updaterecallsummary" style="display:none">
@Html.Action("UpdateSummary", "Tasks")
</div>
<div id="detail" style="display:none">
@Html.Partial("Detail", new ViewDataDictionary<BaseRowView>(new BaseRowView { TaskRow = false, Title = SiteResources.HomeMenuTimesheetDetail, PeriodLength = Model.PeriodLength }))
</div>
<div id="rowChoice" style="display:none">
    @Html.Partial("RowChoice", new ViewDataDictionary<RowType[]>(Model.RowTypes))
    </div>
    <div id="timeInput" style="display:none">
@Html.Partial("TimeInput", new ViewDataDictionary<TimeInputView>())
</div>
<script src="@Url.Content("~/Scripts/main.js")" type="text/javascript"></script>